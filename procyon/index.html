<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>Procyon Sector Navigation Console</title>
    <script src="https://unpkg.com/panzoom@9.4.0/dist/panzoom.min.js"></script>
    <link rel="stylesheet" href="src/css/styles.css">
</head>
<body>
    <div class="console-frame">
        <div class="corner corner-tl"></div>
        <div class="corner corner-tr"></div>
        <div class="corner corner-bl"></div>
        <div class="corner corner-br"></div>
        
        <div class="console-header">
            <div class="console-title"><h1>Procyon Sector Navigation</h1></div>
            <div class="console-status">SYSTEM READY</div>
        </div>
        
        <div class="console-content">
            <div class="scan-line"></div>
            <div class="map-container" id="map-container">
                <!-- SVG will be loaded here -->
            </div>
        </div>
    </div>

    <script>
        // Wait for panzoom to be available
        window.addEventListener('load', function() {
            // Load the SVG file
            fetch('assets/images/procyon-sector-map.svg')
                .then(response => response.text())
                .then(svgText => {
                    const mapContainer = document.getElementById('map-container');
                    mapContainer.innerHTML = svgText;
                    
                    // Initialize panzoom
                    const svg = mapContainer.querySelector('svg');
                    const instance = panzoom(svg, {
                        maxZoom: 8,
                        minZoom: 0.5,
                        bounds: true,
                        boundsPadding: 0.1,
                        zoomDoubleClickSpeed: 1,
                        smoothScroll: false
                    });

                    // Handle touch events
                    mapContainer.addEventListener('touchstart', instance.handleTouchStart);
                    mapContainer.addEventListener('touchmove', instance.handleTouchMove);
                    mapContainer.addEventListener('touchend', instance.handleTouchEnd);

                    // Handle mouse events
                    mapContainer.addEventListener('wheel', instance.zoomWithWheel);

                    // Add click handlers to interactive regions
                    svg.querySelectorAll('rect[id]').forEach(rect => {
                        rect.addEventListener('click', function(event) {
                            const id = this.getAttribute('id');
                            console.log('Clicked element ID:', id);
                            // Prevent zoom on click
                            event.stopPropagation();
                        });
                    });

                    // Center the map
                    const bbox = svg.getBBox();
                    const width = mapContainer.clientWidth;
                    const height = mapContainer.clientHeight;
                    const scale = Math.min(width / bbox.width, height / bbox.height) * 0.9;
                    
                    // Set initial zoom and position
                    instance.transform({
                        scale: scale,
                        x: (width - bbox.width * scale) / 2,
                        y: (height - bbox.height * scale) / 2
                    });
                });
        });
    </script>
</body>
</html>
